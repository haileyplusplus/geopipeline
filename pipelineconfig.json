{
  "name": "pipelineconfig",
  "description": "Configuration of pipeline workflows.",
  "stages": [
    {
      "name": "streets_fetch",
      "module": "catalogfetcher",
      "output_type": "geopandas.GeoDataFrame",
      "output_class": "PipelineFetcher",
      "parameters": {
        "datasource": {
          "domain": "chicago",
          "feed_id": "6imu-meau",
          "name": "Street Center Lines",
          "keep_cols": [
            "street_nam", "street_typ", "ewns_dir",
            "dir_travel", "status", "class", "length",
            "trans_id", "geometry"
          ]
        }
      }
    },
    {
      "name": "bike_routes_fetch",
      "module": "catalogfetcher",
      "output_type": "geopandas.GeoDataFrame",
      "output_class": "PipelineFetcher",
      "parameters": {
        "datasource": {
          "domain": "chicago",
          "feed_id": "3w5d-sru8",
          "name": "Bike Routes",
          "keep_cols": [
            "contraflow", "br_oneway", "displayrou", 
            "st_name", "geometry"
          ]
        }
      }
    },
    {
      "name": "off_street_fetch",
      "module": "catalogfetcher",
      "output_type": "geopandas.GeoDataFrame",
      "output_class": "PipelineFetcher",
      "parameters": {
        "datasource": {
          "domain": "cookgis",
          "feed_id": "900b69139e874c8f823744d8fd5b71eb",
          "name": "Off-Street Bike Trails",
          "keep_cols": [
            "OBJECTID", "Street", "FacName", "Sub_System",
            "ShapeSTLength", "geometry"
          ],
          "filter": [
            {
              "column": "Muni",
              "value": "Chicago",
              "action": {
                "keep": {}
              }
            },
            {
              "column": "Status",
              "value": "Existing",
              "action": {
                "keep": {}
              }
            }
          ]
        }
      }
    },
    {
      "name": "streets_preprocess",
      "module": "map_processor",
      "output_type": "geopandas.GeoDataFrame",
      "output_class": "StreetsPreprocess"
    },
    {
      "name": "bike_routes_preprocess",
      "module": "map_processor",
      "output_type": "geopandas.GeoDataFrame",
      "output_class": "BikeRoutesPreprocess"
    },
    { "name": "off_street_preprocess",
      "module": "map_processor",
      "output_type": "geopandas.GeoDataFrame",
      "output_class": "OffStreetPreprocess"
    },
    { "name": "streets_bike_join" },
    { "name": "bikestreets_off_join" },
    { "name": "community_area_filter" },
    { "name": "network_analyze" },
    { "name": "bikestreets_output"}
  ],
  "workflows": [
    {
      "name": "bikemap",
      "final": "bikestreets_output",
      "stages": [
        {
          "stage": "bikestreets_output",
          "dependencies": ["network_analyze"]
        },
        {
          "stage": "network_analyze",
          "dependencies": ["community_area_filter"]
        },
        {
          "stage": "community_area_filter",
          "dependencies": ["bikestreets_off_join"]
        },
        {
          "stage": "bikestreets_off_join",
          "dependencies": [
            "off_street_preprocess",
            "streets_bike_join"
          ]
        },
        {
          "stage": "off_street_preprocess",
          "dependencies": ["off_street_fetch"]
        },
        {
          "stage": "off_street_fetch",
          "dependencies": []
        },
        {
          "stage": "streets_bike_join",
          "dependencies": [
            "streets_preprocess",
            "bike_routes_preprocess"
          ]
        },
        {
          "stage": "streets_preprocess",
          "dependencies": ["streets_fetch"]
        },
        {
          "stage": "bike_routes_preprocess",
          "dependencies": ["bike_routes_fetch"]
        },
        {
          "stage": "streets_fetch",
          "dependencies": []
        },
        {
          "stage": "bike_routes_fetch",
          "dependencies": []
        }
      ]
    }
  ]
}
